const crypto_sign_SECRETKEYBYTES=64,crypto_sign_BYTES=64;var K=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],L=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function A(r,o,f){for(var t=0;t<16;t++)r[t]=o[t]+f[t]}function Z(r,o,f){for(var t=0;t<16;t++)r[t]=o[t]-f[t]}function M(r,o,f){var t,a,n=0,c=0,e=0,h=0,l=0,s=0,g=0,i=0,M=0,u=0,y=0,p=0,v=0,A=0,w=0,_=0,d=0,E=0,k=0,T=0,Y=0,S=0,U=0,b=0,L=0,m=0,B=0,K=0,Z=0,F=0,I=0,D=f[0],X=f[1],x=f[2],C=f[3],R=f[4],z=f[5],O=f[6],j=f[7],q=f[8],G=f[9],H=f[10],J=f[11],N=f[12],P=f[13],Q=f[14],V=f[15];n+=(t=o[0])*D,c+=t*X,e+=t*x,h+=t*C,l+=t*R,s+=t*z,g+=t*O,i+=t*j,M+=t*q,u+=t*G,y+=t*H,p+=t*J,v+=t*N,A+=t*P,w+=t*Q,_+=t*V,c+=(t=o[1])*D,e+=t*X,h+=t*x,l+=t*C,s+=t*R,g+=t*z,i+=t*O,M+=t*j,u+=t*q,y+=t*G,p+=t*H,v+=t*J,A+=t*N,w+=t*P,_+=t*Q,d+=t*V,e+=(t=o[2])*D,h+=t*X,l+=t*x,s+=t*C,g+=t*R,i+=t*z,M+=t*O,u+=t*j,y+=t*q,p+=t*G,v+=t*H,A+=t*J,w+=t*N,_+=t*P,d+=t*Q,E+=t*V,h+=(t=o[3])*D,l+=t*X,s+=t*x,g+=t*C,i+=t*R,M+=t*z,u+=t*O,y+=t*j,p+=t*q,v+=t*G,A+=t*H,w+=t*J,_+=t*N,d+=t*P,E+=t*Q,k+=t*V,l+=(t=o[4])*D,s+=t*X,g+=t*x,i+=t*C,M+=t*R,u+=t*z,y+=t*O,p+=t*j,v+=t*q,A+=t*G,w+=t*H,_+=t*J,d+=t*N,E+=t*P,k+=t*Q,T+=t*V,s+=(t=o[5])*D,g+=t*X,i+=t*x,M+=t*C,u+=t*R,y+=t*z,p+=t*O,v+=t*j,A+=t*q,w+=t*G,_+=t*H,d+=t*J,E+=t*N,k+=t*P,T+=t*Q,Y+=t*V,g+=(t=o[6])*D,i+=t*X,M+=t*x,u+=t*C,y+=t*R,p+=t*z,v+=t*O,A+=t*j,w+=t*q,_+=t*G,d+=t*H,E+=t*J,k+=t*N,T+=t*P,Y+=t*Q,S+=t*V,i+=(t=o[7])*D,M+=t*X,u+=t*x,y+=t*C,p+=t*R,v+=t*z,A+=t*O,w+=t*j,_+=t*q,d+=t*G,E+=t*H,k+=t*J,T+=t*N,Y+=t*P,S+=t*Q,U+=t*V,M+=(t=o[8])*D,u+=t*X,y+=t*x,p+=t*C,v+=t*R,A+=t*z,w+=t*O,_+=t*j,d+=t*q,E+=t*G,k+=t*H,T+=t*J,Y+=t*N,S+=t*P,U+=t*Q,b+=t*V,u+=(t=o[9])*D,y+=t*X,p+=t*x,v+=t*C,A+=t*R,w+=t*z,_+=t*O,d+=t*j,E+=t*q,k+=t*G,T+=t*H,Y+=t*J,S+=t*N,U+=t*P,b+=t*Q,L+=t*V,y+=(t=o[10])*D,p+=t*X,v+=t*x,A+=t*C,w+=t*R,_+=t*z,d+=t*O,E+=t*j,k+=t*q,T+=t*G,Y+=t*H,S+=t*J,U+=t*N,b+=t*P,L+=t*Q,m+=t*V,p+=(t=o[11])*D,v+=t*X,A+=t*x,w+=t*C,_+=t*R,d+=t*z,E+=t*O,k+=t*j,T+=t*q,Y+=t*G,S+=t*H,U+=t*J,b+=t*N,L+=t*P,m+=t*Q,B+=t*V,v+=(t=o[12])*D,A+=t*X,w+=t*x,_+=t*C,d+=t*R,E+=t*z,k+=t*O,T+=t*j,Y+=t*q,S+=t*G,U+=t*H,b+=t*J,L+=t*N,m+=t*P,B+=t*Q,K+=t*V,A+=(t=o[13])*D,w+=t*X,_+=t*x,d+=t*C,E+=t*R,k+=t*z,T+=t*O,Y+=t*j,S+=t*q,U+=t*G,b+=t*H,L+=t*J,m+=t*N,B+=t*P,K+=t*Q,Z+=t*V,w+=(t=o[14])*D,_+=t*X,d+=t*x,E+=t*C,k+=t*R,T+=t*z,Y+=t*O,S+=t*j,U+=t*q,b+=t*G,L+=t*H,m+=t*J,B+=t*N,K+=t*P,Z+=t*Q,F+=t*V,_+=(t=o[15])*D,c+=38*(E+=t*x),e+=38*(k+=t*C),h+=38*(T+=t*R),l+=38*(Y+=t*z),s+=38*(S+=t*O),g+=38*(U+=t*j),i+=38*(b+=t*q),M+=38*(L+=t*G),u+=38*(m+=t*H),y+=38*(B+=t*J),p+=38*(K+=t*N),v+=38*(Z+=t*P),A+=38*(F+=t*Q),w+=38*(I+=t*V),n=(t=(n+=38*(d+=t*X))+(a=1)+65535)-65536*(a=Math.floor(t/65536)),c=(t=c+a+65535)-65536*(a=Math.floor(t/65536)),e=(t=e+a+65535)-65536*(a=Math.floor(t/65536)),h=(t=h+a+65535)-65536*(a=Math.floor(t/65536)),l=(t=l+a+65535)-65536*(a=Math.floor(t/65536)),s=(t=s+a+65535)-65536*(a=Math.floor(t/65536)),g=(t=g+a+65535)-65536*(a=Math.floor(t/65536)),i=(t=i+a+65535)-65536*(a=Math.floor(t/65536)),M=(t=M+a+65535)-65536*(a=Math.floor(t/65536)),u=(t=u+a+65535)-65536*(a=Math.floor(t/65536)),y=(t=y+a+65535)-65536*(a=Math.floor(t/65536)),p=(t=p+a+65535)-65536*(a=Math.floor(t/65536)),v=(t=v+a+65535)-65536*(a=Math.floor(t/65536)),A=(t=A+a+65535)-65536*(a=Math.floor(t/65536)),w=(t=w+a+65535)-65536*(a=Math.floor(t/65536)),_=(t=_+a+65535)-65536*(a=Math.floor(t/65536)),n=(t=(n+=a-1+37*(a-1))+(a=1)+65535)-65536*(a=Math.floor(t/65536)),c=(t=c+a+65535)-65536*(a=Math.floor(t/65536)),e=(t=e+a+65535)-65536*(a=Math.floor(t/65536)),h=(t=h+a+65535)-65536*(a=Math.floor(t/65536)),l=(t=l+a+65535)-65536*(a=Math.floor(t/65536)),s=(t=s+a+65535)-65536*(a=Math.floor(t/65536)),g=(t=g+a+65535)-65536*(a=Math.floor(t/65536)),i=(t=i+a+65535)-65536*(a=Math.floor(t/65536)),M=(t=M+a+65535)-65536*(a=Math.floor(t/65536)),u=(t=u+a+65535)-65536*(a=Math.floor(t/65536)),y=(t=y+a+65535)-65536*(a=Math.floor(t/65536)),p=(t=p+a+65535)-65536*(a=Math.floor(t/65536)),v=(t=v+a+65535)-65536*(a=Math.floor(t/65536)),A=(t=A+a+65535)-65536*(a=Math.floor(t/65536)),w=(t=w+a+65535)-65536*(a=Math.floor(t/65536)),_=(t=_+a+65535)-65536*(a=Math.floor(t/65536)),n+=a-1+37*(a-1),r[0]=n,r[1]=c,r[2]=e,r[3]=h,r[4]=l,r[5]=s,r[6]=g,r[7]=i,r[8]=M,r[9]=u,r[10]=y,r[11]=p,r[12]=v,r[13]=A,r[14]=w,r[15]=_}function sel25519(r,o,f){for(var t,a=~(f-1),n=0;n<16;n++)t=a&(r[n]^o[n]),r[n]^=t,o[n]^=t}function add(r,o){var f=gf(),t=gf(),a=gf(),n=gf(),c=gf(),e=gf(),h=gf(),l=gf(),s=gf();Z(f,r[1],r[0]),Z(s,o[1],o[0]),M(f,f,s),A(t,r[0],r[1]),A(s,o[0],o[1]),M(t,t,s),M(a,r[3],o[3]),M(a,a,D2),M(n,r[2],o[2]),A(n,n,n),Z(c,t,f),Z(e,n,a),A(h,n,a),A(l,t,f),M(r[0],c,e),M(r[1],l,h),M(r[2],h,e),M(r[3],c,l)}function cswap(r,o,f){var t;for(t=0;t<4;t++)sel25519(r[t],o[t],f)}function set25519(r,o){var f;for(f=0;f<16;f++)r[f]=0|o[f]}function scalarmult(r,o,f){var t,a;for(set25519(r[0],gf0),set25519(r[1],gf1),set25519(r[2],gf1),set25519(r[3],gf0),a=255;a>=0;--a)cswap(r,o,t=f[a/8|0]>>(7&a)&1),add(o,r),add(r,r),cswap(r,o,t)}const D2=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),gf0=gf(),gf1=gf([1]),X=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Y=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);function inv25519(r,o){var f,t=gf();for(f=0;f<16;f++)t[f]=o[f];for(f=253;f>=0;f--)S(t,t),2!==f&&4!==f&&M(t,t,o);for(f=0;f<16;f++)r[f]=t[f]}function S(r,o){M(r,o,o)}function par25519(r){var o=new Uint8Array(32);return pack25519(o,r),1&o[0]}function car25519(r){var o,f,t=1;for(o=0;o<16;o++)f=r[o]+t+65535,t=Math.floor(f/65536),r[o]=f-65536*t;r[0]+=t-1+37*(t-1)}function pack25519(r,o){var f,t,a,n=gf(),c=gf();for(f=0;f<16;f++)c[f]=o[f];for(car25519(c),car25519(c),car25519(c),t=0;t<2;t++){for(n[0]=c[0]-65517,f=1;f<15;f++)n[f]=c[f]-65535-(n[f-1]>>16&1),n[f-1]&=65535;n[15]=c[15]-32767-(n[14]>>16&1),a=n[15]>>16&1,n[14]&=65535,sel25519(c,n,1-a)}for(f=0;f<16;f++)r[2*f]=255&c[f],r[2*f+1]=c[f]>>8}function pack(r,o){var f=gf(),t=gf(),a=gf();inv25519(a,o[2]),M(f,o[0],a),M(t,o[1],a),pack25519(r,t),r[31]^=par25519(f)<<7}function scalarbase(r,o){var f=[gf(),gf(),gf(),gf()];set25519(f[0],X),set25519(f[1],Y),set25519(f[2],gf1),M(f[3],X,Y),scalarmult(r,f,o)}function modL(r,o){var f,t,a,n;for(t=63;t>=32;--t){for(f=0,a=t-32,n=t-12;a<n;++a)o[a]+=f-16*o[t]*L[a-(t-32)],f=Math.floor((o[a]+128)/256),o[a]-=256*f;o[a]+=f,o[t]=0}for(f=0,a=0;a<32;a++)o[a]+=f-(o[31]>>4)*L[a],f=o[a]>>8,o[a]&=255;for(a=0;a<32;a++)o[a]-=f*L[a];for(t=0;t<32;t++)o[t+1]+=o[t]>>8,r[t]=255&o[t]}function reduce(r){var o,f=new Float64Array(64);for(o=0;o<64;o++)f[o]=r[o];for(o=0;o<64;o++)r[o]=0;modL(r,f)}function ts64(r,o,f,t){r[o]=f>>24&255,r[o+1]=f>>16&255,r[o+2]=f>>8&255,r[o+3]=255&f,r[o+4]=t>>24&255,r[o+5]=t>>16&255,r[o+6]=t>>8&255,r[o+7]=255&t}function gf(r){var o,f=new Float64Array(16);if(r)for(o=0;o<r.length;o++)f[o]=r[o];return f}function checkArrayTypes(){for(var r=0;r<arguments.length;r++)if(!(arguments[r]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function crypto_hashblocks_hl(r,o,f,t){for(var a,n,c,e,h,l,s,g,i,M,u,y,p,v,A,w,_,d,E,k,T,Y,S,U,b,L,m=new Int32Array(16),B=new Int32Array(16),Z=r[0],F=r[1],I=r[2],D=r[3],X=r[4],x=r[5],C=r[6],R=r[7],z=o[0],O=o[1],j=o[2],q=o[3],G=o[4],H=o[5],J=o[6],N=o[7],P=0;t>=128;){for(E=0;E<16;E++)k=8*E+P,m[E]=f[k+0]<<24|f[k+1]<<16|f[k+2]<<8|f[k+3],B[E]=f[k+4]<<24|f[k+5]<<16|f[k+6]<<8|f[k+7];for(E=0;E<80;E++)if(a=Z,n=F,c=I,e=D,h=X,l=x,s=C,R,i=z,M=O,u=j,y=q,p=G,v=H,A=J,N,S=65535&(Y=N),U=Y>>>16,b=65535&(T=R),L=T>>>16,S+=65535&(Y=(G>>>14|X<<18)^(G>>>18|X<<14)^(X>>>9|G<<23)),U+=Y>>>16,b+=65535&(T=(X>>>14|G<<18)^(X>>>18|G<<14)^(G>>>9|X<<23)),L+=T>>>16,S+=65535&(Y=G&H^~G&J),U+=Y>>>16,b+=65535&(T=X&x^~X&C),L+=T>>>16,T=K[2*E],S+=65535&(Y=K[2*E+1]),U+=Y>>>16,b+=65535&T,L+=T>>>16,T=m[E%16],U+=(Y=B[E%16])>>>16,b+=65535&T,L+=T>>>16,b+=(U+=(S+=65535&Y)>>>16)>>>16,S=65535&(Y=d=65535&S|U<<16),U=Y>>>16,b=65535&(T=_=65535&b|(L+=b>>>16)<<16),L=T>>>16,S+=65535&(Y=(z>>>28|Z<<4)^(Z>>>2|z<<30)^(Z>>>7|z<<25)),U+=Y>>>16,b+=65535&(T=(Z>>>28|z<<4)^(z>>>2|Z<<30)^(z>>>7|Z<<25)),L+=T>>>16,U+=(Y=z&O^z&j^O&j)>>>16,b+=65535&(T=Z&F^Z&I^F&I),L+=T>>>16,g=65535&(b+=(U+=(S+=65535&Y)>>>16)>>>16)|(L+=b>>>16)<<16,w=65535&S|U<<16,S=65535&(Y=y),U=Y>>>16,b=65535&(T=e),L=T>>>16,U+=(Y=d)>>>16,b+=65535&(T=_),L+=T>>>16,F=a,I=n,D=c,X=e=65535&(b+=(U+=(S+=65535&Y)>>>16)>>>16)|(L+=b>>>16)<<16,x=h,C=l,R=s,Z=g,O=i,j=M,q=u,G=y=65535&S|U<<16,H=p,J=v,N=A,z=w,E%16==15)for(k=0;k<16;k++)T=m[k],S=65535&(Y=B[k]),U=Y>>>16,b=65535&T,L=T>>>16,T=m[(k+9)%16],S+=65535&(Y=B[(k+9)%16]),U+=Y>>>16,b+=65535&T,L+=T>>>16,_=m[(k+1)%16],S+=65535&(Y=((d=B[(k+1)%16])>>>1|_<<31)^(d>>>8|_<<24)^(d>>>7|_<<25)),U+=Y>>>16,b+=65535&(T=(_>>>1|d<<31)^(_>>>8|d<<24)^_>>>7),L+=T>>>16,_=m[(k+14)%16],U+=(Y=((d=B[(k+14)%16])>>>19|_<<13)^(_>>>29|d<<3)^(d>>>6|_<<26))>>>16,b+=65535&(T=(_>>>19|d<<13)^(d>>>29|_<<3)^_>>>6),L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,m[k]=65535&b|L<<16,B[k]=65535&S|U<<16;S=65535&(Y=z),U=Y>>>16,b=65535&(T=Z),L=T>>>16,T=r[0],U+=(Y=o[0])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[0]=Z=65535&b|L<<16,o[0]=z=65535&S|U<<16,S=65535&(Y=O),U=Y>>>16,b=65535&(T=F),L=T>>>16,T=r[1],U+=(Y=o[1])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[1]=F=65535&b|L<<16,o[1]=O=65535&S|U<<16,S=65535&(Y=j),U=Y>>>16,b=65535&(T=I),L=T>>>16,T=r[2],U+=(Y=o[2])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[2]=I=65535&b|L<<16,o[2]=j=65535&S|U<<16,S=65535&(Y=q),U=Y>>>16,b=65535&(T=D),L=T>>>16,T=r[3],U+=(Y=o[3])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[3]=D=65535&b|L<<16,o[3]=q=65535&S|U<<16,S=65535&(Y=G),U=Y>>>16,b=65535&(T=X),L=T>>>16,T=r[4],U+=(Y=o[4])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[4]=X=65535&b|L<<16,o[4]=G=65535&S|U<<16,S=65535&(Y=H),U=Y>>>16,b=65535&(T=x),L=T>>>16,T=r[5],U+=(Y=o[5])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[5]=x=65535&b|L<<16,o[5]=H=65535&S|U<<16,S=65535&(Y=J),U=Y>>>16,b=65535&(T=C),L=T>>>16,T=r[6],U+=(Y=o[6])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[6]=C=65535&b|L<<16,o[6]=J=65535&S|U<<16,S=65535&(Y=N),U=Y>>>16,b=65535&(T=R),L=T>>>16,T=r[7],U+=(Y=o[7])>>>16,b+=65535&T,L+=T>>>16,L+=(b+=(U+=(S+=65535&Y)>>>16)>>>16)>>>16,r[7]=R=65535&b|L<<16,o[7]=N=65535&S|U<<16,P+=128,t-=128}return t}function crypto_hash(r,o,f){var t,a=new Int32Array(8),n=new Int32Array(8),c=new Uint8Array(256),e=f;for(a[0]=1779033703,a[1]=3144134277,a[2]=1013904242,a[3]=2773480762,a[4]=1359893119,a[5]=2600822924,a[6]=528734635,a[7]=1541459225,n[0]=4089235720,n[1]=2227873595,n[2]=4271175723,n[3]=1595750129,n[4]=2917565137,n[5]=725511199,n[6]=4215389547,n[7]=327033209,crypto_hashblocks_hl(a,n,o,f),f%=128,t=0;t<f;t++)c[t]=o[e-f+t];for(c[f]=128,c[(f=256-128*(f<112?1:0))-9]=0,ts64(c,f-8,e/536870912|0,e<<3),crypto_hashblocks_hl(a,n,c,f),t=0;t<8;t++)ts64(r,8*t,a[t],n[t]);return 0}function crypto_sign(r,o,f,t){var a,n,c=new Uint8Array(64),e=new Uint8Array(64),h=new Uint8Array(64),l=new Float64Array(64),s=[gf(),gf(),gf(),gf()];crypto_hash(c,t,32),c[0]&=248,c[31]&=127,c[31]|=64;var g=f+64;for(a=0;a<f;a++)r[64+a]=o[a];for(a=0;a<32;a++)r[32+a]=c[32+a];for(crypto_hash(h,r.subarray(32),f+32),reduce(h),scalarbase(s,h),pack(r,s),a=32;a<64;a++)r[a]=t[a];for(crypto_hash(e,r,f+64),reduce(e),a=0;a<64;a++)l[a]=0;for(a=0;a<32;a++)l[a]=h[a];for(a=0;a<32;a++)for(n=0;n<32;n++)l[a+n]+=e[a]*c[n];return modL(r.subarray(32),l),g}function sign(r,o){if(checkArrayTypes(r,o),o.length!==crypto_sign_SECRETKEYBYTES)throw new Error("bad secret key size");var f=new Uint8Array(crypto_sign_BYTES+r.length);return crypto_sign(f,r,r.length,o),f}function signOpDetached(r,o){for(var f=sign(r,o),t=new Uint8Array(crypto_sign_BYTES),a=0;a<t.length;a++)t[a]=f[a];return t}module.exports = signOpDetached;